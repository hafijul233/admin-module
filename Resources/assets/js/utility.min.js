/**
 * Trigger Delete Modal
 */
function initDeleteModal() {
    $(".delete-btn").click(function (event) {
        //stop href to trigger
        event.preventDefault();

        //Model
        var deleteModel = new bootstrap.Modal(document.getElementById("deleteModal"), {backdrop: 'static'});
        //ahref has link
        var url = this.getAttribute('href');
        if (url.length > 0 && url !== "#") {
            //Ajax
            $.get(url, function (response) {
                $("#deleteConfirmationForm").empty().html(response);
            }, 'html').done(function () {
            }).fail(function (error) {
                $("#deleteConfirmationForm").empty().html(error.responseText);
            }).always(function () {
                deleteModel.show();
            });
        }
    });
}

/**
 * Modal Status Update
 */

/*function toggleEnabledStatus() {
    $(".toggle-class").change(function () {
        var toggle = $(this);

        var fieldData = (toggle.prop("checked") === true)
            ? toggle.data("on")
            : toggle.data("off");

        $.get(TOGGLE_URL, {m: toggle.data("model"), i: toggle.data("id"), f: toggle.data("field"), v: fieldData},
            function (response) {
                if (response.status === 200) {
                    //@TODO add notify popup
                    console.log(response);
                } else {
                    console.log(response);
                }
            }, "json");
    });
}*/

/**
 * mark search keyword in table
 * @param searchElement
 * @param targetTable
 */
function highLightQueryString(searchElement, targetTable) {
    var JqSearchElement = $("#" + searchElement);
    var JqTargetTable = $("#" + targetTable);

    var searchText = JqSearchElement.val();
    var searchTextLength = searchText.length;
    //only if search text in not empty
    if (searchTextLength > 0) {
        JqTargetTable.find("tr").each(function () {

            $(this).find("td").each(function () {

                var tableCell = $(this);

                if (!tableCell.hasClass("exclude-search")) {

                    var innerHtml = tableCell.html();

                    var patternPosition = innerHtml.search(new RegExp(searchText, "igmsu"));

                    if (patternPosition !== -1) {
                        var innerContent = innerHtml.substr(patternPosition, searchTextLength);

                        tableCell.html(
                            innerHtml.replace(innerContent,
                                "<span class='text-dark bg-warning py-1 px-0'>" + innerContent + "</span>"
                            )
                        );
                    }

                }
            });
        });
    }
}

$(document).ready(function () {
    $("#select-all-checkbox").click(function () {
        $(".mark-checkbox").each(function () {
            $(this).prop("checked", true);
        });
    });

    $("#unselect-all-checkbox").click(function () {
        $(".mark-checkbox").each(function () {
            $(this).prop("checked", false);
        });
    });
});
